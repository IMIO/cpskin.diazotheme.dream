<?xml version="1.0" encoding="utf-8"?>
<rules xmlns="http://namespaces.plone.org/diazo"
       xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
       xmlns:css="http://namespaces.plone.org/diazo/css">

  <replace css:content-children="#portaltab-index_html a">
      <span class="icon-home" />
  </replace>
  <!-- Header / banner specific to minisite mode -->
  <rules if="$isinminisitemode">

      <replace css:content-children="#portal-header">
          <div id="top-languages">
            <xsl:copy-of select="//*[@id='portal-languageselector']" />
          </div>

          <div id="top-actions" class="minisitessss">
            <div id="top-actions-inner" class="minisites">
            </div>
          </div>
      </replace>

      <replace css:content-children="#minisite-search">
          <xsl:copy-of select="//*[@id='portal-searchbox']"/>
      </replace>


      <drop css:content="#viewlet-above-content #viewlet-minisite" />
      <drop css:content="#portal-breadcrumbs" />

  </rules>

  <!-- Standard Header / banner -->
  <rules if-not="$isinminisitemode">

      <replace css:content-children="#portal-header">
          <div id="top-navigation">
            <div id="top-navigation-inner">
                <div id="top-actions">
                      <div id="top-actions-inner">
                          <div id="top-actions-actions">
                            <div id="div-siteactions">
                                <xsl:copy-of select="//*[@id='portal-siteactions']" />
                            </div>
                            <xsl:apply-templates select="./*[@id='social-viewlet']" />
                          </div>
                        <div class="visualClear"></div>
                  </div>
                </div> 
                <div id="top-logo">
                    <xsl:apply-templates select="./*[@id='portal-logo']" /> 
                </div>
                <xsl:apply-templates select="./*[@id='portal-globalnav']" />
                <div id="languages-tools">
                    <xsl:copy-of select="./*[@id='portal-languageselector']" />
                    <xsl:copy-of select="./*[@id='portal-personaltools-wrapper']" />
                </div>
                  
              <xsl:apply-templates select="./*[not(@id) or (@id!='portal-personaltools-wrapper'
                                                            and @id!='portal-searchbox'
                                                            and @id!='social-viewlet'
                                                            and @id!='portal-globalnav'
                                                            and @id!='portal-languageselector'
                                                            and @id!='portal-logo')]"/>
              

            </div>
          </div>
          <div id="hidden-search" style="display:none;">
            <xsl:copy-of select="./*[@id='portal-searchbox']"/>
          </div>
          <script>
            // jquery for search button
           $( ".btn-search" ).click(function() {
             $( "#hidden-search" ).slideToggle(
             "fast",
             function () {
                    $("#searchGadget").focus();
                });
             });
        </script>
      </replace>
       <after css:content="#portal-globalnav li:last-child">
         <xsl:if test="not($is_homepage)">
            <li>
                 <a href="#"  class="btn-search">
                    <span class="ico-search"></span>
                    <span>Search</span>
                </a>
            </li>             
         </xsl:if>
      </after>
        <before if="$is_homepage" css:content-children="#cpskin-banner">
            <div id="top-search">
              <div id="top-search-inner">
                <xsl:copy-of select="//*[@id='portal-searchbox']"/>
              </div>
            </div>
        </before>

      <drop css:content="#minisite-search" />

  </rules>


  <drop css:content="#portal-siteactions" />

</rules>
